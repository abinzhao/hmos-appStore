import{d as S,R as c,T as Be,v as Ge,w as Ue,b as be,e as u,P as ye,x as Ke,C as qe,u as Je,y as He,z as Qe,f as de,j as J,B as We,D as Xe,o as Ye,E as Ze,F as er,I as rr,_ as tr,k as nr,l as we,H as xe,J as ir,m as l,q as ar,K as H,L as X,M as or,N as Y,O as Ce,n as sr,Q as lr,S as cr,U as ur,V as dr,t as fr}from"./index-FD1T5Q2O.js";import{S as Q,P as pr}from"./index-DV0-gRm5.js";import{T as Ee}from"./tabs-D--12H4a.js";import{L as fe}from"./index-BFBZy68U.js";import"./Combination-C62u9g4Y.js";import"./index-B1gdGVBm.js";function Pe(r){var e=r.title,t=r.description,n=r.actions,i=e||t,o=n&&n.length,s=i||o;return[s,i,o]}var vr=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return o},mr=function(r){var e,t=r.style,n=r.className,i=r.title,o=r.description,s=r.actions,a=r.prefixCls,w=r.simple,g=vr(Pe({title:i,description:o,actions:s}),3),v=g[0],h=g[1],f=g[2];if(!v)return null;var d=a+"-footer",b=S(d,n,(e={},e[d+"-with-actions"]=f,e)),x=function(){var C=c.createElement("div",{className:a+"-actions-list"},s.map(function(_,y){return c.createElement("div",{className:a+"-actions-item",key:""+y},_)}));return w?c.createElement("div",{className:a+"-actions-list"},c.createElement(Be,{prefixCls:a,popup:function(){return C}},c.createElement("div",{className:S(a+"-actions-item",a+"-actions-item-trigger")},c.createElement("span",null,c.createElement(Ge,null))))):C};return c.createElement("div",{className:b,style:t},h&&c.createElement("div",{className:S(d+"-block",a+"-caption")},i&&c.createElement("div",{className:a+"-caption-title",title:i},i),o&&!w&&c.createElement("div",{className:a+"-caption-description",title:o},o)),f&&c.createElement("div",{className:S(d+"-block",a+"-actions")},x()))},Oe=!Ue&&!be(window==null?void 0:window.IntersectionObserver);function gr(r,e){e===void 0&&(e={});var t=u.useRef(),n=function(){t.current&&(t.current.disconnect(),t.current=null)},i=function(o){o&&(n(),Oe&&(t.current=new IntersectionObserver(r,e),t.current.observe(o)))};return{observer:t.current,cor:i,dor:n}}var hr=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},pe=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return o};function br(r){var e=r.defaultInView,t=r.unobserverOnEnter,n=t===void 0?!0:t,i=r.onChange,o=r.target,s=hr(r,["defaultInView","unobserverOnEnter","onChange","target"]),a=pe(u.useState(Oe?e:!0),2),w=a[0],g=a[1],v=u.useCallback(function(x,C){var _=pe(x,1),y=_[0],$=C.thresholds.some(function(E){return y.intersectionRatio>=E}),L=$&&y.isIntersecting;g(L),i==null||i(L,y),L&&n&&C.unobserve(y.target)},[i,n]),h=gr(v,s),f=h.cor,d=h.dor,b=h.observer;return u.useEffect(function(){var x=e&&n;return x?d():o&&f(o),d},[o,e,n]),{inView:w,observer:b}}var M=function(){return M=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},M.apply(this,arguments)},yr=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},ve=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return o},W=0,wr={footerPosition:"inner",preview:!0};function xr(r,e){var t,n=u.useContext(qe),i=n.getPrefixCls,o=n.componentConfig,s=n.rtl,a=Je(r,wr,o==null?void 0:o.Image),w=a.style,g=a.className,v=a.src,h=a.width,f=a.height,d=a.title,b=a.description,x=a.actions,C=a.footerPosition,_=a.simple,y=a.loader,$=a.loaderClassName,L=a.error,E=a.preview,D=a.previewProps,F=a.alt,ee=a.onClick,B=a.index,re=a._index,te=a.onError,ne=a.onLoad,N=a.lazyload,je=yr(a,["style","className","src","width","height","title","description","actions","footerPosition","simple","loader","loaderClassName","error","preview","previewProps","alt","onClick","index","_index","onError","onLoad","lazyload"]),_e=He(),V=u.useContext(Qe),k=V.previewGroup,Ne=V.handleVisibleChange,Ie=V.registerPreviewUrl,Se=V.registerPreviewProps,Le=V.setCurrentIndex,P=u.useMemo(function(){return de(D)?D:{}},[D]),Ve=u.useMemo(function(){return de(N)?N:{}},[N]),O=u.useMemo(function(){return J(B)||J(re)?(W=J(B)?B:re,W):W++},[]),G=P.src||v,ke=ve(Pe({title:d,description:b,actions:x}),1),U=ke[0],R=We("beforeLoad"),ie=R.isLoading,K=R.isError,I=R.isLoaded,Re=R.isBeforeLoad,T=R.setStatus,z=u.useRef(!1),ae=ve(Xe(!1,{defaultValue:P.defaultVisible,value:P.visible}),2),oe=ae[0],Me=ae[1],q=u.useMemo(function(){return Ye(P,["visible","defaultVisible","src","onVisibleChange"])},[P]),p=i("image"),Te=!be(P.visible),ze=S(p,(t={},t[p+"-rtl"]=s,t[p+"-simple"]=_,t[p+"-before-load"]=Re,t[p+"-loading"]=ie,t[p+"-loading-error"]=K,t[p+"-with-footer-inner"]=I&&U&&C==="inner",t[p+"-with-footer-outer"]=I&&U&&C==="outer",t[p+"-with-preview"]=I&&E&&!K&&!Te,t),g),j=u.useRef();function Ae(m){z.current=!0,T("loaded"),ne&&ne(m)}function $e(m){z.current=!0,T("error"),te&&te(m)}function se(m){E&&k?(Le(O),Ne(!0)):E&&le(!0),ee&&ee(m)}function le(m){P.onVisibleChange&&P.onVisibleChange(m,oe),Me(m)}var ce=br(M({target:j.current,defaultInView:!N},Ve)).inView;u.useEffect(function(){z.current=!1},[v]),u.useEffect(function(){j.current&&(ce?((j.current.src||v)&&j.current.src!==v&&(j.current.src=v),!z.current&&!j.current.complete&&T("loading")):T("lazyload"))},[v,ce]),u.useEffect(function(){if(k){var m=Se(O,q);return function(){return m(O)}}},[O,k,q]),u.useEffect(function(){if(k){var m=Ie(O,G,E);return function(){return m(O)}}},[O,k,G,E]);var De=c.createElement("div",{className:p+"-error"},c.createElement("div",{className:p+"-error-icon"},c.createElement(Ze,null)),F&&c.createElement("div",{className:p+"-error-alt"},F)),ue=c.createElement("div",{className:S(p+"-loader",$)},c.createElement("div",{className:p+"-loader-spin"},c.createElement(er,null),c.createElement("div",{className:p+"-loader-spin-text"},"Loading"))),Fe=function(){if(y===!0)return ue;var m=y||ue;return N||y?m:null};return c.createElement("div",{className:ze,style:Object.assign({width:h,height:f},w),ref:e},c.createElement("img",M({ref:j,className:p+"-img",tabIndex:0},_e({onPressEnter:se}),je,N||v===void 0?{}:{src:v},{title:d,width:h,height:f,onLoad:Ae,onError:$e,onClick:se,alt:F})),!I&&c.createElement("div",{className:p+"-overlay"},K&&(L||De),ie&&Fe()),I&&U&&c.createElement(mr,{title:d,description:b,actions:x,prefixCls:p,simple:_}),I&&E&&c.createElement(ye,M({visible:oe,src:G},q,{onVisibleChange:le})))}var Cr=c.forwardRef(xr),A=Cr;A.Preview=ye;A.PreviewGroup=Ke;A.displayName="Image";function me(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ge(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?me(Object(t),!0).forEach(function(n){nr(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):me(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Er(r,e){var t=u.useContext(rr),n=t.prefixCls,i=n===void 0?"arco":n,o=r.spin,s=r.className,a=ge(ge({"aria-hidden":!0,focusable:!1,ref:e},r),{},{className:"".concat(s?s+" ":"").concat(i,"-icon ").concat(i,"-icon-share-external")});return o&&(a.className="".concat(a.className," ").concat(i,"-icon-loading")),delete a.spin,delete a.isIcon,c.createElement("svg",tr({fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48"},a),c.createElement("path",{strokeMiterlimit:"16",d:"M18 20h-7a1 1 0 0 0-1 1v20a1 1 0 0 0 1 1h26a1 1 0 0 0 1-1V21a1 1 0 0 0-1-1h-7m2.368-5.636L24.004 6l-8.364 8.364M24.003 28V6.604"}))}var Z=c.forwardRef(Er);Z.defaultProps={isIcon:!0};Z.displayName="IconShareExternal";const Pr=r=>{var o;const{data:e={}}=r||{},{t}=we(),n=xe(),{user:i}=ir();return l.jsx("div",{className:"app-item-card",onClick:()=>n(`/appDetail?id=${e==null?void 0:e.id}&type=detail`),children:l.jsxs(Q,{direction:"vertical",children:[l.jsx(A,{className:"icon",src:`${ar}/${e==null?void 0:e.app_icon}`,preview:!1}),l.jsxs("div",{className:"info",children:[l.jsx("div",{className:"info-title",children:e==null?void 0:e.app_name}),l.jsx(H,{size:"small",color:"green",children:e!=null&&e.app_version?`v${e==null?void 0:e.app_version}`:"beta"})]}),l.jsx(H,{size:"small",color:"green",children:e!=null&&e.app_category?`${e==null?void 0:e.app_category}`:"beta"}),l.jsx("div",{className:"info-description",children:e==null?void 0:e.description}),l.jsx(Q,{children:(o=e==null?void 0:e.keywords)==null?void 0:o.map(s=>l.jsx(H,{size:"small",color:"arcoblue",children:s}))}),l.jsxs(Q,{className:"info-action",children:[(i.id===(e==null?void 0:e.user_id)||i.role==="admin")&&l.jsx(X,{size:"small",type:"text",onClick:s=>{s.stopPropagation(),n(`/editApp?id=${e==null?void 0:e.id}&type=edit`)},children:t("appEdit")}),l.jsx(or,{type:"vertical"}),l.jsx(pr,{focusLock:!0,title:t("appRemovedPupupTitle"),content:t("appRemovedPupupDesc"),onOk:()=>{Y.info({content:"ok"})},onCancel:()=>{Y.error({content:"cancel"})},children:(i.id===(e==null?void 0:e.user_id)||i.role==="admin")&&l.jsx(X,{size:"small",type:"text",status:"warning",children:t("appRemoved")})})]})]})})},Or=Ee.TabPane,he=Ce.Option,jr={textAlign:"center"};function kr(){const{t:r}=we(),e=xe(),[t,n]=u.useState("3"),[i,o]=u.useState(""),[s,a]=u.useState([]),[w,g]=u.useState(!1);u.useState([]);const v=[{title:r("alreadyOnShelves"),value:"3"},{title:r("pendingListing"),value:"2"},{title:r("underReview"),value:"1"}];u.useEffect(()=>{},[]);const h=async f=>{try{g(!0);let d={application_status:f};i&&(d.category=JSON.stringify(i));const b=await fr.getApplist(d);a(b)}catch(d){console.log(d),Y.error((d==null?void 0:d.message)||r("APIerror")),a([])}finally{g(!1)}};return u.useEffect(()=>{h(t)},[t,i]),l.jsx("div",{className:"app-market-page",children:l.jsxs(sr,{hoverable:!0,style:{width:"100%",height:"calc(100vh - 155px)",overflow:"auto",borderRadius:"12px"},children:[l.jsx(X,{type:"primary",icon:l.jsx(Z,{}),onClick:()=>{e("/editApp")},children:r("submitSoftware")}),l.jsxs(Ce,{style:{width:"200px",marginBottom:"16px"},placeholder:r("selectCategory"),onChange:o,defaultValue:"",children:[l.jsx(he,{value:"",children:"全部"}),lr.map(f=>l.jsx(he,{value:f.value,children:f.label},f.value))]}),l.jsx(Ee,{tabPosition:"top",animation:!0,justify:!0,style:jr,type:"capsule",size:"large",activeTab:t,onChange:f=>n(f),children:v.map(f=>l.jsx(Or,{title:f.title,children:(s==null?void 0:s.length)<=0?l.jsx("div",{className:"flex items-center justify-center",style:{width:"100%",height:"calc(100vh - 155px)"},children:w?l.jsx(cr,{dot:!0,loading:!0}):l.jsx(ur,{imgSrc:dr,description:r("noPage")})}):l.jsx(fe,{grid:{gutter:0,span:6},dataSource:s,bordered:!1,render:(d,b)=>l.jsx(fe.Item,{children:l.jsx(Pr,{data:d})},b)})},f.value))})]})})}export{kr as default};
