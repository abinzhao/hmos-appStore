import{aS as P,R as i,aP as ke,aT as qe,aC as Ge,aU as Je,aV as _e,aW as Qe,aX as en,aY as nn,e as s,aZ as rn,w as tn,a_ as an,C as on,u as ln,D as un,a$ as cn,b0 as sn,b1 as fn,f as dn,Z as mn,a3 as pn,d as he,b2 as vn,b3 as xe,o as Cn,h as Oe,b4 as gn,L as we}from"./index-FD1T5Q2O.js";import{F as bn}from"./Combination-C62u9g4Y.js";var k=function(){return k=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},k.apply(this,arguments)};function yn(e){var r=nn(),t=r.prefixCls,o=r.simple;return i.createElement(x,k({prefixCls:t,simple:o},e),e.content)}var D=function(e){var r=e.icon;if(!r&&r!==null&&(r=i.createElement(ke,null),e.isNotice))switch(e.noticeType){case"info":r=i.createElement(Je,null);break;case"success":r=i.createElement(Ge,null);break;case"warning":r=i.createElement(ke,null);break;case"error":r=i.createElement(qe,null);break}return e.isNotice&&(e.hideCancel=!0),e.title=r===null&&e.title===null?null:i.createElement("span",null,r,e.title),e};function Ne(e,r){var t,o=document.createElement("div");document.body.appendChild(o);var a=en();function c(f){var m=i.createElement(_e,k({},a),i.createElement(yn,k({},f,{onCancel:p})));t?t.render(m):t=Qe(m,o)}var n=c,u=k(k({},e),{visible:!1}),h=function(){var f,m=e.onOk||e.onConfirm;m&&(f=m()),f&&f.then&&(u.confirmLoading=!0,n(u),f.then(function(){p(!0)},function(O){console.error(O),u.confirmLoading=!1,n(u)})),f||p(!0)};u.onOk=h,u=D(u),u.visible=!0,n(u);function d(){t=t==null?void 0:t._unmount(),o.parentNode&&o.parentNode.removeChild(o);for(var f=0;f<P.length;f++){var m=P[f];if(m===E){P.splice(f,1);break}}}function p(f){!f&&e.onCancel&&e.onCancel(),u.visible=!1,u.afterClose=function(){e.afterClose&&e.afterClose(),d()},n(u)}function g(f){u=k(k(k({},u),{title:e.title}),f),u=D(u),n(u)}function E(){u.visible=!1,u.afterClose=function(){e.afterClose&&e.afterClose(),d()},n(u)}return P.push(E),{close:E,update:g}}var w=function(){return w=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},w.apply(this,arguments)},Pe=function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),a,c=[],n;try{for(;(r===void 0||r-- >0)&&!(a=o.next()).done;)c.push(a.value)}catch(u){n={error:u}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}return c};function En(e,r){var t=Pe(s.useState(!0),2),o=t[0],a=t[1],c=Pe(s.useState(e),2),n=c[0],u=c[1];s.useImperativeHandle(r,function(){return{update:function(p){u(p)},close:function(){a(!1)}}});function h(){var p=n.onOk&&n.onOk();p&&p.then&&(u(function(g){return w(w({},g),{confirmLoading:!0})}),p.then(function(){a(!1)},function(g){console.error(g),u(function(E){return w(w({},E),{confirmLoading:!1})})})),p||a(!1)}function d(){n.onCancel&&n.onCancel(),a(!1)}return i.createElement(x,w({unmountOnExit:!0,simple:!0},n,{visible:o,onOk:h,onCancel:d}),n.content)}const kn=s.forwardRef(En);var b=function(){return b=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b.apply(this,arguments)};function hn(){var e=s.useRef(),r=i.createElement(rn,{ref:e}),t=0;function o(c){var n;t+=1;var u=s.createRef(),h=b({},c);function d(){c.afterClose&&c.afterClose(),g()}var p=i.createElement(kn,b({key:t,ref:u},D(b({},c)),{afterClose:d}));(n=e.current)===null||n===void 0||n.addInstance(p);function g(){var m;(m=e.current)===null||m===void 0||m.removeInstance(p)}function E(){var m;(m=u.current)===null||m===void 0||m.close()}function f(m){var O;h=b(b({},h),m),(O=u.current)===null||O===void 0||O.update(D(b({},h)))}return P.push(E),{close:E,update:f}}var a={confirm:function(c){return o(b({},c))}};return["info","success","warning","error"].forEach(function(c){a[c]=function(n){return o(b(b({},n),{isNotice:!0,noticeType:c}))}}),[a,r]}var y=function(){return y=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},y.apply(this,arguments)},xn=function(e,r){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)r.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(t[o[a]]=e[o[a]]);return t},ee=function(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),a,c=[],n;try{for(;(r===void 0||r-- >0)&&!(a=o.next()).done;)c.push(a.value)}catch(u){n={error:u}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}return c},ne=null,On=0;tn||document.documentElement.addEventListener("click",function(e){ne={left:e.clientX,top:e.clientY},setTimeout(function(){ne=null},100)},!0);var wn={mask:!0,maskClosable:!0,mountOnEnter:!0,escToExit:!0,getPopupContainer:function(){return document.body},alignCenter:!0};function Pn(e,r){var t,o,a,c=s.useContext(on),n=ln(e,wn,(a=c.componentConfig)===null||a===void 0?void 0:a.Modal),u=n.className,h=n.style,d=n.visible,p=n.simple,g=n.title,E=n.children,f=n.cancelText,m=n.okText,O=n.okButtonProps,Re=n.cancelButtonProps,re=n.getPopupContainer,H=re===void 0?function(){return document.body}:re,M=n.footer,V=n.afterClose,Te=n.confirmLoading,$=n.mountOnEnter,W=n.unmountOnExit,Z=n.afterOpen,Fe=n.hideCancel,te=n.autoFocus,ae=n.focusLock,Ie=n.maskClosable,S=n.mask,Me=n.alignCenter,oe=n.getChildrenPopupContainer,Se=n.wrapClassName,A=n.escToExit,le=n.modalRender,Le=n.maskStyle,je=n.wrapStyle,ie=n.closeIcon,Be=xn(n,["className","style","visible","simple","title","children","cancelText","okText","okButtonProps","cancelButtonProps","getPopupContainer","footer","afterClose","confirmLoading","mountOnEnter","unmountOnExit","afterOpen","hideCancel","autoFocus","focusLock","maskClosable","mask","alignCenter","getChildrenPopupContainer","wrapClassName","escToExit","modalRender","maskStyle","wrapStyle","closeIcon"]),R=s.useRef(null),ue=s.useRef(null),L=s.useRef(null),ce=ee(s.useState(),2),se=ce[0],fe=ce[1],de=ee(s.useState(),2),me=de[0],De=de[1],j=s.useRef(null),pe=s.useRef(!1),T=s.useRef(!1),z=s.useRef(!0);d&&z.current&&(z.current=!1);var B=s.useRef();B.current||(B.current=On++);var ve=ee(un(!1,{defaultValue:!1,value:Te}),2),He=ve[0],K=ve[1],v=c.getPrefixCls("modal",n.prefixCls),U=c.locale,Ce=c.rtl,Ve=!p,$e="closable"in n?n.closable:Ve,We=s.useCallback(function(){return cn(H())},[H]);sn(We,{hidden:d&&S});var F=function(){n.onCancel&&n.onCancel()},ge=function(l){A&&d&&l.key===gn.key&&(l.stopPropagation(),F())},X=s.useRef(!1),Ze=function(l){T.current&&(T.current=!1,!X.current&&Ie&&S&&l.target===l.currentTarget&&setTimeout(function(){F()},100))},Ae=function(l){var C=n.onConfirm,_=n.onOk,I=_||C,N;I&&(N=I(l)),N&&N.then&&(K(!0),N.then(function(){K(!1)},function(Q){K(!1),console.error(Q)}))};s.useEffect(function(){var l=null;return A&&(l=setTimeout(function(){var C;fn(document.body,R.current)&&((C=R.current)===null||C===void 0||C.focus())})),function(){l&&clearTimeout(l)}},[d,A]);var ze=function(){var l;if(d&&me===void 0&&R.current){var C=+((l=window.getComputedStyle(R.current,null))===null||l===void 0?void 0:l.zIndex);isNaN(C)||De(C+1)}},Ke=function(){if(M!==null){var l=i.createElement(we,y({onClick:F},Re),f||U.Modal.cancelText),C=i.createElement(we,y({loading:He,onClick:Ae,type:"primary"},O),m||U.Modal.okText),_=Oe(M)?M(l,C):M||i.createElement(i.Fragment,null,!Fe&&l,C);return i.createElement("div",{className:v+"-footer"},_)}},Y=c.focusLock.modal,Ue=!!Y,Xe=dn(Y)&&Y.autoFocus,q=ae!==void 0?ae:Ue,G=te!==void 0?te:Xe,be=i.createElement(_e,y({},c,{prefixCls:n.prefixCls||c.prefixCls,locale:U,zIndex:me||1050,getPopupContainer:function(l){return typeof oe=="function"?oe(l):ue.current}}),g&&i.createElement("div",{className:v+"-header"},i.createElement("div",{className:v+"-title",id:"arco-dialog-"+B.current},g)),i.createElement("div",{ref:ue,className:v+"-content"},E),Ke(),$e&&(ie!==void 0?i.createElement("span",{onClick:F,className:v+"-close-icon"},ie):i.createElement(mn,{tabIndex:-1,onClick:F,className:v+"-close-icon",role:"button","aria-label":"Close"},i.createElement(pn,null)))),Ye=g?{"aria-labelledby":"arco-dialog-"+B.current}:{},ye=i.createElement("div",y({role:"dialog","aria-modal":"true"},Ye,{className:he(v,(t={},t[v+"-simple"]=p,t[v+"-rtl"]=Ce,t),u),style:h,ref:L}),q?i.createElement(bn,{crossFrame:!1,disabled:!d,autoFocus:G,lockProps:{tabIndex:-1,onKeyDown:ge}},be):i.createElement(i.Fragment,null,be)),J=function(l){if(!pe.current){var C="";if(j.current){var _=l.getBoundingClientRect(),I=j.current,N=I.left,Q=I.top;C=N-_.left+"px "+(Q-_.top)+"px"}l.style.transformOrigin=C}},Ee=z.current?!$:!!L.current;return d||Ee?i.createElement(vn,{visible:d,forceRender:Ee,getContainer:H},i.createElement("div",{ref:r},S?i.createElement(xe,{in:d,timeout:400,appear:!0,mountOnEnter:$,classNames:"fadeModal",unmountOnExit:W,onEnter:function(l){l&&(l.style.display="block")},onExited:function(l){l&&(l.style.display="none")}},i.createElement("div",{"aria-hidden":!0,className:v+"-mask",style:Le})):null,i.createElement("div",y({},Cn(Be,["content","icon","showIcon","isNotice","noticeType","onCancel","onOk","onConfirm","closable","prefixCls"]),{tabIndex:!q||!G?-1:null,ref:function(l){R.current=l,ze()},className:he(v+"-wrapper",(o={},o[v+"-wrapper-no-mask"]=!S,o[v+"-wrapper-align-center"]=Me,o[v+"-wrapper-rtl"]=Ce,o),Se),style:y(y({},je||{}),{display:d||se?"block":"none",overflow:!d&&se?"hidden":""}),onKeyDown:!q||!G?ge:null,onMouseDown:function(l){T.current=l.target===l.currentTarget},onClick:Ze}),i.createElement(xe,{in:d,timeout:400,appear:!0,classNames:"zoomModal",unmountOnExit:W,mountOnEnter:$,onEnter:function(l){l&&(fe(!0),j.current=ne,pe.current=!!l.style.transformOrigin,J(l),L.current=l)},onEntered:function(l){l&&(J(l),j.current=null,Z==null||Z())},onExit:function(){X.current=!0},onExited:function(l){l&&(fe(!1),J(l),V==null||V(),X.current=!1,W&&(L.current=null))}},i.cloneElement(Oe(le)?le(ye):ye,{onMouseDown:function(){T.current=!1},onMouseUp:function(){T.current=!1}}))))):null}var x=s.forwardRef(Pn);x.displayName="Modal";x.config=an;x.confirm=function(e){return Ne(e)};x.useModal=hn;["info","success","warning","error"].forEach(function(e){x[e]=function(r){return Ne(y(y({},r),{isNotice:!0,noticeType:e}))}});x.destroyAll=function(){for(;P.length;){var e=P.pop();e&&e()}};export{x as E};
